<section class="studio">
  <div class="studio__header" appScrollReveal>
    <span class="studio__label">3D Customization Studio</span>
    <h1 class="studio__title">Design Your <span class="studio__accent">Masterpiece</span></h1>
    <p class="studio__desc">
      Personalize your product in real-time with our interactive 3D preview.
    </p>
  </div>

  <div class="studio__container">
    <div class="studio__grid">
      <!-- 3D Canvas -->
      <div class="studio__canvas-col" appScrollReveal>
        <div class="studio__canvas-wrapper" #canvasContainer></div>
        <p class="studio__canvas-hint">
          <span class="material-icons-outlined">touch_app</span>
          {{ getCanvasHint() }}
        </p>
      </div>

      <!-- Control Panel -->
      <div class="studio__panel" appScrollReveal [revealDelay]="200">
        <h2 class="studio__panel-title">Customization Options</h2>

        <!-- Product Type Selector -->
        <div class="studio__section">
          <h3 class="studio__section-title">
            <span class="material-icons-outlined">category</span> Product Type
          </h3>
          <div class="studio__product-grid">
            @for (product of productOptions; track product.type) {
              <button
                class="studio__product-btn"
                [class.studio__product-btn--active]="activeProduct() === product.type"
                (click)="setProduct(product.type)"
              >
                <span class="material-icons-outlined">{{ product.icon }}</span>
                <span class="studio__product-label">{{ product.label }}</span>
              </button>
            }
          </div>
        </div>

        <!-- Body Color -->
        <div class="studio__section">
          <h3 class="studio__section-title">
            <span class="material-icons-outlined">palette</span> Base Color
          </h3>
          <div class="studio__color-grid">
            @for (color of colorPresets; track color.hex) {
              <button
                class="studio__color-swatch"
                [class.studio__color-swatch--active]="activeColor() === color.hex"
                [style.background]="color.hex"
                [attr.aria-label]="color.label"
                (click)="setColor(color.hex)"
              ></button>
            }
          </div>
        </div>

        <!-- Custom Text -->
        <div class="studio__section">
          <h3 class="studio__section-title">
            <span class="material-icons-outlined">text_fields</span> Custom Text
          </h3>
          <input
            type="text"
            class="studio__input"
            placeholder="Enter your text..."
            [value]="customText()"
            (input)="updateText($event)"
          />
        </div>

        <!-- Text Color -->
        <div class="studio__section">
          <h3 class="studio__section-title">
            <span class="material-icons-outlined">format_color_text</span> Text Color
          </h3>
          <div class="studio__color-grid">
            @for (tc of textColorPresets; track tc.hex) {
              <button
                class="studio__color-swatch"
                [class.studio__color-swatch--active]="activeTextColor() === tc.hex"
                [style.background]="tc.hex"
                [attr.aria-label]="tc.label"
                (click)="setTextColor(tc.hex)"
              ></button>
            }
          </div>
        </div>

        <!-- Upload Design -->
        <div class="studio__section">
          <h3 class="studio__section-title">
            <span class="material-icons-outlined">upload_file</span> Upload Design
          </h3>

          <input
            type="file"
            #fileInput
            accept="image/png,image/jpeg,image/svg+xml"
            (change)="onFileSelected($event)"
            style="display: none"
          />

          @if (uploadedImage()) {
            <div class="studio__upload-preview">
              <img [src]="uploadedImage()" alt="Uploaded design preview" />
              <button class="studio__upload-remove" (click)="removeUpload()">
                <span class="material-icons-outlined">close</span>
              </button>
            </div>
          } @else {
            <div
              class="studio__upload-zone"
              [class.studio__upload-zone--drag-active]="isDragOver()"
              (click)="triggerFileInput()"
              (dragover)="onDragOver($event)"
              (dragleave)="onDragLeave($event)"
              (drop)="onDrop($event)"
            >
              <span class="material-icons-outlined studio__upload-icon">cloud_upload</span>
              <p class="studio__upload-text">Drag & drop your image here</p>
              <span class="studio__upload-hint">or click to browse — PNG, JPG, SVG (max 10MB)</span>
            </div>
          }
        </div>

        <button class="studio__save-btn">
          <span class="material-icons-outlined">shopping_cart</span>
          Add to Cart — $14.99
        </button>
      </div>
    </div>
  </div>
</section>
